/*
 * 007_i2c_master_tx_testing.c
 *
 *  Created on: 5 nov. 2020
 *      Author: msw
 */

#include "stm32f407xx.h"
void delay(void);

/*
 * PB6 => SCL
 * PB9 => SDA
 */

void i2c_gpio_init() {
	/*!< PB6 => SCL*/
	gpio_pin_config_t loc_oi2c_pin_config = {
	GPIO_PIN_6,
	GPIO_MODER_AF,
	GPIO_OSPEEDR_VERY_HIGH,
	GPIO_OTYPER_OD,
	GPIO_PUPDR_PU,
	GPIO_AF4 };

	gpio_handle_t loc_ogpiof_handle = { GPIOB, &loc_oi2c_pin_config };
	gpio_init(&loc_ogpiof_handle);

	/*!< PB9 => SDA*/
	loc_oi2c_pin_config.pin_number = GPIO_PIN_9;
	gpio_init(&loc_ogpiof_handle);
}

void i2c1_init() {
	i2c_config_t loc_oi2c_config = { I2C_SCL_SPEED_SM, I2C_FM_DUTY_2, 0,
			I2C_ACK_EN };
	i2c_handle_t loc_oi2c1_handle = { I2C1, &loc_oi2c_config };
	i2c_init(&loc_oi2c1_handle);
}

int main() {
	i2c_gpio_init();
	for (;;)
		;
	return 0;
}

void delay(void) {
	for (uint32_t loc_u32index = 0; loc_u32index < 0xFFFFU; ++loc_u32index)
		;
}
